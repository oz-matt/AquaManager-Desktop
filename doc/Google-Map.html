<!DOCTYPE html>
<html>
  <head>
    <title>Aqua Manager</title>
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <style>
	    /* Always set the map height explicitly to define the size of the div
		 * element that contains the map.
		 */
       #map {
        height: 100%;
        width: 100%;
       }
	    /* Optional: Makes the sample page fill the window. */
		  html, body {
		  height: 100%;
		  margin: 0;
		  padding: 0;
		}
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>
	  var map;
	  var markerArray = new Array();
	  var radius_global;
	  var lat_global;
	  var lng_global;

      function initMap() {
        var pos = {lat: 45.378802, lng: -70.242796};
        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 7,
          center: pos
        });
        var marker = new google.maps.Marker({
          position: pos,
          map: map
        });

		markerArray.push(marker);

		//map.setCenter(new google.maps.LatLng(45.378802, -68.242796));
		marker = new google.maps.Marker({
          position: {lat: 45.378802, lng: -68.242796},
          map: map
        });

		markerArray.push(marker);
		
		// Drawing shapes
		  var drawingManager = new google.maps.drawing.DrawingManager({
			drawingMode: google.maps.drawing.OverlayType.MARKER,
			drawingControl: true,
			drawingControlOptions: {
			  position: google.maps.ControlPosition.TOP_CENTER,
			  drawingModes: ['marker', 'circle', 'polygon', 'polyline', 'rectangle']
			},
			markerOptions: {icon: 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png'},
			circleOptions: {
			  fillColor: '#ffff00',
			  fillOpacity: 1,
			  strokeWeight: 5,
			  clickable: false,
			  editable: true,
			  zIndex: 1
			}
		  });

		  drawingManager.setMap(map);
		  
		  google.maps.event.addListener(drawingManager, 'circlecomplete', function(circle) {
			var radius = circle.getRadius();
			radius_global = radius;
			// alert("circlecomplete event: " + radius);
			//console.log('radius', circle.getRadius());
			//console.log('lat', circle.getCenter().lat());
			//console.log('lng', circle.getCenter().lng());
			lat_global = circle.getCenter().lat();
			lng_global = circle.getCenter().lng();
		  });
		  
		  google.maps.event.addListener(drawingManager, 'polygoncomplete', function(polygon) {
			 var coordinatesArray = polygon.getPath().getArray();
			 alert("coordinatesArray: " + coordinatesArray);
		  });
		  
		  google.maps.event.addListener(drawingManager, 'overlaycomplete', function(event) {
			if (event.type == 'circle') {
			  var radius = event.overlay.getRadius();
			  //radius_global = radius;
			  // alert("overlaycomplete event: " + radius);
			}
			if (event.type == 'polygon') {
			  var coordinatesArray = event.overlay.getPath().getArray();
			  alert("overlaycomplete event: " + coordinatesArray);
			}
		  });
      }

	  function SetCenter(x, y, type)
	  {
        map.setCenter(new google.maps.LatLng(x, y));
      }

	  function AddMarker(x, y) {
		  var markerOptions = {
          position : {lat: x, lng: y},
		  map : map
	    };
        var marker = new google.maps.Marker(markerOptions);
	    markerArray.push(marker);
      }

	  function SetZoom(type)
	  {
        map.setZoom(type);
      }

	  // Sets the map on all markers in the array.
      function setMapOnAll(map) {
        for (var i = 0; i < markerArray.length; i++) {
          markerArray[i].setMap(map);
        }
      }

	  // Removes the markers from the map, but keeps them in the array.
      function clearMarkers() {
        setMapOnAll(null);
      }

	  // Shows any markers currently in the array.
      function showMarkers() {
        setMapOnAll(map);
      }

      // Deletes all markers in the array by removing references to them.
      function deleteMarkers() {
        clearMarkers();
        markers = [];
      }
	  
	  function getCircle() {
		// alert(radius_global);
		return radius_global;
	  }
	  
	  function getCircleLat() {
		// alert(lat_global);
		return lat_global;
	  }
	  
	  function getCircleLng() {
		// alert(lng_global);
		return lng_global;
	  }
	  
	  function setCircle(lat, lng, radius) {
		lat_global = lat;
		lng_global = lng;
		radius_global = radius;
	  }
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBkm1VkR2KkSz23AnGU-lj8XApl04m8EGE&callback=initMap&language=en&libraries=drawing">
    </script>
  </body>
</html>